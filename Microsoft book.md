# Глава 1: Введение в сетевые технологии

Практически любой компьютер, который вы используете сегодня, подключен к сети. Сетевые компьютеры стали настолько привычными, что мы часто воспринимаем их как должное. Однако «за кулисами» работает множество компонентов и технологий, обеспечивающих доступ компьютера к ресурсам сети.

В этой главе я начну с определения названий многих физических и логических компонентов сети. Затем я представлю компоненты, входящие в состав очень маленьких сетей, и покажу, как добавляются новые элементы по мере роста сети. В завершение я расскажу об организациях по стандартизации, которые помогают гарантировать, что все эти компьютеры могут работать вместе, независимо от того, кто их произвел и где они находятся.

**Темы главы:**

- Сравнение логических и физических сетей
- Организация сети домашних компьютеров
- Организация сети для малых и домашних офисов (SOHO)
- Организация сети больших офисов
- Корпоративные сети (Networking Enterprises)
- Понимание организаций по стандартизации
    

---

Сравнение логических и физических сетей

**Сеть** — это группа компьютеров и других устройств, соединенных вместе. Эти соединения могут быть проводными (кабели), беспроводными или комбинированными. Сети описываются как в логических, так и в физических терминах.

**Логическая организация** сети определяет её общий дизайн. Она различает **локальные вычислительные сети (LAN)** и **глобальные сети (WAN)**. Логический дизайн дает высокоуровневый обзор всей сети и может не отображать мелкие компоненты, такие как все коммутаторы, маршрутизаторы и брандмауэры.

В отличие от этого, **физическая сетевая инфраструктура** включает детали физических компонентов. Физические компоненты — это устройства и кабели, которые можно потрогать.

Эта глава посвящена концепциям логической организации сети. Вы узнаете о различных типах сетевых дизайнов, которые можно встретить в домашних сетях, малых офисах, крупных организациях и корпорациях. Глава 2 предоставит обзор физических компонентов.

Важно понимать, как работают устройства в логической структуре, чтобы полностью осознать, как данные перемещаются по сети. Как только вы поймете движение данных, вы будете лучше подготовлены к обслуживанию сети и устранению неполадок.

---

Организация сети домашних компьютеров

Сегодня большинство домашних компьютеров являются частью сети. Как минимум, они имеют возможность подключения к Интернету — гигантской «сети сетей».

Обычно компьютер получает доступ в Интернет через модем провайдера интернет-услуг (**ISP**). Это может быть кабельный модем (широкополосное подключение) или модем для коммутируемого доступа (dial-up). Широкополосные подключения (кабельное ТВ, оптоволокно, DSL) широко доступны в городах. В сельской местности, где нет широкополосного доступа, всё ещё используются телефонные линии (dial-up) или спутниковый интернет.

> **Включите локальный брандмауэр (Firewall)** Когда компьютер подключается к Интернету напрямую через ISP (минуя внутренний маршрутизатор), он подвергается значительному риску, так как имеет публичный IP-адрес и доступен из любой точки мира. Злоумышленники часто сканируют сеть в поисках незащищенных компьютеров. Включение программного брандмауэра обеспечивает уровень защиты.

Когда пользователи добавляют дома дополнительные компьютеры, они обычно хотят объединить их в сеть для совместного использования ресурсов (например, принтеров или файлов).

Типичная домашняя сеть включает:

- **Беспроводной маршрутизатор (Wireless Router):** Объединяет проводные и беспроводные устройства.
- **Доступ в Интернет:** Один кабельный модем подключается к провайдеру, а затем к беспроводному маршрутизатору. Это позволяет всем устройствам в доме делить одно подключение к Интернету, экономя деньги.
    

Большинство домашних беспроводных маршрутизаторов выполняют сразу несколько функций:

1. **Беспроводная точка доступа (WAP):** Обеспечивает подключение для беспроводных клиентов.
2. **Маршрутизация (Routing):** Пересылает данные из внутренней сети в Интернет и обратно.
3. **Трансляция сетевых адресов (NAT):** Преобразует публичные IP-адреса Интернета в частные IP-адреса внутренней сети. Это скрывает внутренние компьютеры от атак извне.
4. **DHCP (Dynamic Host Configuration Protocol):** Автоматически выдает клиентам IP-адреса и настройки (адрес DNS, шлюз по умолчанию).
5. **Брандмауэр (Firewall):** Блокирует нежелательный трафик из Интернета.
    

---

Организация сети малых и домашних офисов (SOHO)

Сети **SOHO (Small Office/Home Office)** очень похожи на продвинутые домашние сети. Они также считаются локальными сетями (**LAN**). В них могут работать до 10 сотрудников (иногда до 100).

Ключевое отличие SOHO от домашней сети — наличие **сервера**. Сервер может использоваться для хранения файлов бизнеса, хотя это и не строго обязательно (файлы можно хранить и на главном компьютере, но это усложняет резервное копирование). Также часто используются многофункциональные сетевые принтеры.

> **Безопасность беспроводных сетей** Критически важно защищать беспроводные сети, используя WPA2 (802.11i). Если сеть не защищена, злоумышленник может подключиться к ней, просто находясь рядом (техника "war driving"), и получить доступ к ресурсам.

Понимание локальных сетей (LAN)

Домашняя сеть и SOHO — это примеры LAN. **LAN** — это группа компьютеров и устройств, соединенных в одной физической локации (дом, офис). LAN обеспечивает быстрое соединение: обычно 100 Мбит/с или 1 Гбит/с для проводных сетей и 54-300 Мбит/с для беспроводных.

> **Мегабиты и Гигабиты** Скорость LAN измеряется в битах. **Mbps** = мегабит в секунду (миллион бит). **Gbps** = гигабит в секунду (миллиард бит). Обратите внимание: скорость сети измеряется в битах (строчная 'b'), а объём памяти — в байтах (заглавная 'B', например, 4 GB RAM).

Сравнение Рабочих групп (Workgroups) и Доменов (Domains)

**Рабочая группа (Workgroup):** Обычно используется в SOHO (1-10 пользователей). Все компьютеры равноправны. Учетные записи пользователей (логин/пароль) хранятся на _каждом_ отдельном компьютере.

- _Проблема:_ Если у вас 5 пользователей и 5 компьютеров, и каждому нужен доступ ко всем компьютерам, придется создать по 5 учетных записей на каждом ПК. Пользователям придется запоминать кучу паролей, что небезопасно (они начнут их записывать).
    

**Домен (Domain):** Когда офис растет (более 10 компьютеров), переходят к доменной структуре. Для этого нужен сервер, настроенный как **Контроллер домена** (Domain Controller).

- Контроллер домена хранит базу данных **Active Directory Domain Services (AD DS)**.
- **Преимущество:** Единый вход (**Single Sign-On, SSO**). Пользователю нужна только одна учетная запись, чтобы войти на любой компьютер в домене.
    

**Зачем переходить на домен?**

1. **Единый вход:** Не нужно помнить разные пароли для разных ПК.
2. **Централизованное управление:** Администратор может управлять всеми пользователями и компьютерами из одного места.
3. **Групповые политики (Group Policy):** Можно настроить параметры (например, скринсейвер с паролем) один раз, и они применятся ко всем компьютерам сразу.
4. **Отказоустойчивость:** Если есть два контроллера домена, данные реплицируются. Если один сломается, второй продолжит работу.

---

Организация сети больших офисов

В больших офисах больше людей и компьютеров. Чтобы сеть работала быстро, её нужно оптимизировать. Главное отличие — разделение сети на **подсети (subnets)**.

**Подсеть** — это группа компьютеров, отделенная от других маршрутизатором (router).

Зачем это нужно? Представьте дорожный трафик. Чем больше машин, тем больше пробок и аварий. В сети так же: чем больше компьютеров в одной куче, тем больше трафика и **коллизий** (когда данные сталкиваются и становятся нечитаемыми). Разделение на подсети с помощью маршрутизаторов локализует трафик, уменьшая перегрузки.

**Роль коммутаторов и маршрутизаторов:**

- **Коммутаторы (Switches):** Соединяют компьютеры _внутри_ одной подсети.
- **Маршрутизаторы (Routers):** Соединяют разные _подсети_ между собой.

---

Корпоративные сети (Networking Enterprises)

"Предприятие" (Enterprise) обычно подразумевает организацию с множеством филиалов и локаций. Отличия от просто большого офиса:

1. **IT-персонал:** Вместо 1-2 универсалов ("эникейщиков"), здесь работают целые отделы узкопрофильных специалистов (эксперты по почте, базам данных, безопасности и т.д.).
2. **Связь локаций (WAN):** Офисы соединены не просто кабелем, а технологиями глобальных сетей (WAN).
    

Понимание глобальных сетей (WAN)

**WAN** создается, когда две или более локальных сетей (LAN) в разных географических точках соединяются.

- Соединение WAN почти всегда _медленнее_, чем LAN. Например, внутри офиса скорость 1000 Мбит/с, а канал между офисами (например, T1) — всего 1.544 Мбит/с.
- Организации обычно арендуют линии связи у телекоммуникационных компаний.
    

Филиалы и удаленный доступ

Филиалы часто меньше головного офиса и могут не иметь своих серверов или IT-персонала. Они подключаются к центру через WAN. Для мобильных сотрудников (например, продавцов) используется удаленный доступ:

1. **Dial-up:** Старый метод через телефонную линию.
2. **VPN (Virtual Private Network):** Клиент подключается к Интернету, а затем создает защищенный туннель к серверу компании. Это позволяет безопасно работать с внутренними ресурсами через публичный Интернет.
    

---

Понимание организаций по стандартизации

Чтобы оборудование разных производителей работало вместе, нужны стандарты. Вот ключевые организации:

1. **IETF (Internet Engineering Task Force):** Определяет стандарты Интернета (включая протокол **TCP/IP**). Они выпускают документы **RFC** (Request for Comments). Например, RFC 791 описывает IPv4, а RFC 2460 — IPv6.
2. **W3C (World Wide Web Consortium):** Определяет стандарты для Веба (WWW), такие как HTML и HTTP. Директором является сэр Тим Бернерс-Ли, изобретатель WWW.
    - _Важно:_ WWW — это не Интернет, а лишь один из способов доступа к информации в Интернете.
        
3. **IEEE (Institute of Electrical and Electronics Engineers):** Определяет стандарты "низкого уровня" (физическое оборудование).
    - **IEEE 802.3** — стандарты для проводного Ethernet.
    - **IEEE 802.11** — стандарты для беспроводных сетей (Wi-Fi).
        
4. **ITU (International Telecommunication Union):** Агентство ООН, занимающееся вопросами телекоммуникаций (спутниковые орбиты, телефонные стандарты, модемы).
    

---

Основные выводы (The Essentials and Beyond)

- **LAN (Локальная сеть):** Группа компьютеров в одной физической локации с высокой скоростью соединения.
- **WAN (Глобальная сеть):** Две или более LAN, соединенные более медленным каналом связи на больших расстояниях.
- В домашних и малых сетях используются маршрутизаторы для доступа в Интернет, NAT и DHCP.
- Для сетей с более чем 10 пользователями рекомендуется использовать **домены** (с контроллером домена) вместо рабочих групп для упрощения управления и безопасности.
    

---

# Глава 2: Обзор сетевых компонентов

В первой главе мы рассмотрели сети с точки зрения их логической организации (LAN и WAN). Теперь пришло время углубиться в детали и посмотреть на конкретные «шестеренки» сети — оборудование и технологии, которые заставляют всё это работать.

В этой главе мы разберем, как именно данные путешествуют от одного компьютера к другому. Мы посмотрим на физические устройства, такие как коммутаторы и маршрутизаторы, и узнаем, чем они отличаются. Также мы обсудим, как данные передаются по кабелям и какие существуют схемы (топологии) соединения компьютеров.

**Темы главы:**

- Сравнение трафика: Unicast, Broadcast и Multicast
- Понимание сетевого оборудования (хабы, коммутаторы, маршрутизаторы)
- Изучение протоколов и сервисов
- Понимание базовых топологий (Шина, Кольцо, Звезда, Ячеистая)
    

---

## Сравнение трафика: Unicast, Broadcast и Multicast

Когда компьютеры общаются в сети, они не просто «кричат» в провод. Существует три основных способа отправки данных, в зависимости от того, кому эти данные предназначены.

### 1. Unicast (Одноадресная передача)

Это связь **«один-к-одному»**. Один компьютер отправляет данные ровно одному конкретному получателю.

- _Пример:_ Вы заходите на веб-сайт. Ваш компьютер отправляет запрос серверу, а сервер отвечает лично вам.
- _Аналогия:_ Телефонный звонок. Вы набираете номер и говорите только с одним человеком.
    

### 2. Broadcast (Широковещательная передача)

Это связь **«один-всем»**. Один компьютер отправляет данные, и их получают **все** остальные компьютеры в этой локальной сети (подсети).

- _Пример:_ Компьютер только что включился и хочет получить IP-адрес. Он кричит: «Эй, кто-нибудь (DHCP-сервер), дайте мне адрес!». Это слышат все, но отвечает только сервер.
- _Аналогия:_ Учитель в классе говорит: «Внимание всем, завтра контрольная!».
- _Важно:_ Маршрутизаторы обычно блокируют широковещательный трафик, чтобы он не засорял другие сети.
    

### 3. Multicast (Многоадресная передача)

Это связь **«один-группе»**. Один компьютер отправляет данные, но их получают только те, кто «подписался» на этот поток.

- _Пример:_ Онлайн-трансляция видео или вебинар. Данные отправляются один раз, а получают их только те, кто подключился к трансляции. Это экономит трафик по сравнению с отправкой копии каждому зрителю лично (unicast).
- _Аналогия:_ Подписка на журнал. Журнал получают только те, кто на него подписался.
    

---

## Понимание сетевого оборудования

Чтобы соединить компьютеры, нам нужны специальные устройства. Раньше использовались **концентраторы (Hubs)**, но сегодня стандартом стали **коммутаторы (Switches)**.

### Концентраторы (Hubs) — Устаревшие

Хаб — это простое и «глупое» устройство. У него есть несколько портов (разъемов). **Как он работает:** Когда данные приходят на один порт, хаб просто копирует их и отправляет **на все остальные порты**. **Минусы:**

1. **Безопасность:** Данные получают все компьютеры в сети, даже если они предназначались только одному. Злоумышленник может подключиться к хабу и перехватить чужие пароли (с помощью сниффера).
2. **Лишний трафик:** Сеть забивается ненужными данными, так как все слышат всё.
    

### Коммутаторы (Switches) — Современный стандарт

Коммутатор выглядит как хаб, но работает намного умнее. Он умеет «учиться». **Как он работает:**

1. Каждая сетевая карта имеет уникальный физический адрес — **MAC-адрес** (Media Access Control).
2. Коммутатор запоминает, какой MAC-адрес подключен к какому порту (составляет внутреннюю таблицу).
3. Когда приходят данные для конкретного компьютера (Unicast), коммутатор отправляет их **только на тот порт**, где находится получатель. **Плюсы:**
    

- **Безопасность:** Данные не попадают на чужие компьютеры.
- **Скорость:** Каждый порт работает на полной скорости, не мешая другим.
    

### Маршрутизаторы (Routers)

Если коммутаторы соединяют компьютеры _внутри_ одной сети, то маршрутизаторы соединяют _разные_ сети между собой (например, вашу домашнюю сеть и Интернет). **Ключевые функции:**

- Работают с **IP-адресами** (логическими), а не только с MAC-адресами.
- Не пропускают широковещательный трафик (Broadcast), предотвращая «широковещательные штормы».
- Выполняют роль шлюза (Gateway) для выхода в другие сети.

### Сетевые адаптеры (NIC)

Network Interface Card — это плата или чип в вашем компьютере, куда втыкается кабель (или антенна Wi-Fi).

- Каждый NIC имеет уникальный **MAC-адрес**, прошитый на заводе (например, `00-1B-44-11-3A-B7`).
- Первая половина адреса (3 байта) — это идентификатор производителя (OUI). Вторая половина — уникальный номер карты.

---

## Изучение протоколов и сервисов

Оборудование — это «железо», но чтобы оно работало, нужны правила общения. Эти правила называются **протоколами**.

### Ethernet

Это самый популярный стандарт для локальных сетей (проводных). Он описывает, как данные упаковываются в «кадры» (frames) и передаются по кабелю. Ethernet использует метод доступа **CSMA/CD** (Carrier Sense Multiple Access with Collision Detection).

- **Как это работает (простыми словами):**
    
    1. **Слушай (Carrier Sense):** Перед отправкой компьютер слушает, свободен ли кабель.
    2. **Если свободно — говори (Transmit):** Начинает передачу.
    3. **Если перебили (Collision Detection):** Если два компьютера начали говорить одновременно, происходит **коллизия** (столкновение). Оба замолкают, ждут случайное время и пробуют снова.
        
- _Примечание:_ В современных сетях с коммутаторами (Switches) коллизии практически исчезли, так как каждый порт изолирован.
    

### Модель OSI (Краткий обзор)

Сетевое взаимодействие сложное, поэтому его делят на 7 уровней (подробно будет в Главе 3). Сейчас важно запомнить, что:

- Коммутаторы работают на **Уровне 2 (Data Link)** — используют MAC-адреса.
- Маршрутизаторы работают на **Уровне 3 (Network)** — используют IP-адреса.
    

---

## Понимание базовых топологий

Топология — это схема того, как компьютеры соединены друг с другом физически или логически.

### 1. Шина (Bus) — Устаревшая

Все компьютеры подключены к одному длинному кабелю (коаксиальному).

- **Проблема:** Если кабель порвется в _любом_ месте, **вся сеть падает**.
- Требует «терминаторов» на концах кабеля, чтобы сигнал не отражался обратно.
    

### 2. Кольцо (Ring) — Устаревшая (Token Ring)

Компьютеры соединены в замкнутое кольцо. Специальный цифровой маркер (token) бегает по кругу.

- Передавать данные может только тот, у кого сейчас маркер.
- Нет коллизий, но сеть медленная и дорогая.
    

### 3. Звезда (Star) — Самая популярная сегодня

Все компьютеры подключены отдельными кабелями к центральному устройству (коммутатору или хабу).

- **Плюс:** Если кабель одного компьютера порвется, перестанет работать только этот компьютер. Остальная сеть продолжит работать.
- **Минус:** Если сломается центральный коммутатор, вся сеть упадет (единая точка отказа).
    

### 4. Ячеистая топология (Mesh)

Каждое устройство соединено с каждым (или со многими другими).

- Используется там, где нужна **максимальная надежность** (отказоустойчивость), например, в соединениях между серверами или маршрутизаторами провайдеров.
- Если один кабель порвется, трафик пойдет по другому пути.
- **Минус:** Очень много кабелей, дорого и сложно настраивать.
    

---

## Основные выводы (The Essentials)

- **Unicast** — трафик от одного к одному. **Broadcast** — от одного ко всем в подсети.
- **Коммутаторы (Switches)** умнее и безопаснее **хабов (Hubs)**, так как передают unicast-трафик только адресату, используя MAC-адреса.
- **Маршрутизаторы (Routers)** соединяют разные подсети и блокируют широковещательный трафик.
- **Топология Звезда (Star)** — стандарт для современных офисных и домашних сетей (Ethernet). Она надежна, так как разрыв одного кабеля не валит всю сеть.
- **CSMA/CD** — правило этикета в Ethernet: «Послушай, прежде чем говорить. Если перебил кого-то — замолчи и подожди».

# Глава 3: Понимание модели OSI

Сетевое взаимодействие — процесс сложный. Чтобы упростить его понимание и разработку стандартов, были созданы специальные модели. Две самые главные из них — это **модель OSI** (7 уровней) и **модель TCP/IP** (4 уровня).

## 1. Понимание модели OSI (The OSI Model)

**OSI** (Open Systems Interconnection) — это теоретическая модель, разработанная организацией ISO. Она делит процесс передачи данных на **7 уровней**.

Главная цель модели — позволить компьютерам с разными операционными системами (например, Windows и Linux) общаться друг с другом.

**Преимущества модели:**

- **Изоляция уровней:** Изменения на одном уровне не ломают другие. Например, программисту, пишущему браузер (уровень Приложений), не нужно думать о том, какой кабель используется (Физический уровень).
- **Стандартизация:** Разным производителям проще создавать совместимое оборудование.
- **Упрощение отладки:** Если сеть не работает, можно проверять уровни по очереди (например, сначала проверить кабель — уровень 1).
    

### 7 Уровней модели OSI

Их принято считать снизу вверх (от "железа" к софту) или сверху вниз. В книге предлагаются мнемонические фразы для запоминания (на английском: _Please Do Not Throw Sausage Pizza Away_).

Вот описание каждого уровня (снизу вверх):

#### **Уровень 1: Физический (Physical Layer)**

- **Что делает:** Занимается передачей сырых данных — битов (0 и 1) — по физической среде.
- **Оборудование:** Кабели (витая пара, оптоволокно), коннекторы, **хабы (Hubs)**, повторители (Repeaters).
- **Единица данных:** **Бит (Bit)**.
- **Суть:** Превращает данные в электрические сигналы, световые импульсы или радиоволны.

#### **Уровень 2: Канальный (Data Link Layer)**

- **Что делает:** Обеспечивает надежную передачу данных внутри одной локальной сети (LAN). Определяет физическую адресацию (**MAC-адреса**).
    
- **Подуровни:**
    1. **LLC (Logical Link Control):** Управляет потоком и ошибками.
    2. **MAC (Media Access Control):** Управляет доступом к среде (чтобы два компьютера не говорили одновременно — CSMA/CD).
    
- **Оборудование:** **Коммутаторы (Switches)**, мосты (Bridges), сетевые карты (NIC).
- **Единица данных:** **Кадр (Frame)**.
- **Важно:** Здесь "живут" MAC-адреса (например, `A4-BA-DB-FA-60-AD`).
    

#### **Уровень 3: Сетевой (Network Layer)**

- **Что делает:** Отвечает за маршрутизацию — находит лучший путь для данных между _разными_ сетями. Использует логическую адресацию (**IP-адреса**).
- **Оборудование:** **Маршрутизаторы (Routers)**, коммутаторы 3-го уровня.
- **Единица данных:** **Пакет (Packet)**.
- **Протоколы:** **IPv4**, **IPv6**, ICMP (ping), ARP (преобразует IP в MAC), IPSec.
- **Суть:** Если Канальный уровень доставляет письмо соседу по дому, то Сетевой уровень доставляет письмо в другой город.
    

#### **Уровень 4: Транспортный (Transport Layer)**

- **Что делает:** Отвечает за надежную доставку данных и управление потоком. Разбивает большие файлы на мелкие части.
    
- **Два главных протокола:**
    
    1. **TCP (Transmission Control Protocol):** Надежный, с установкой соединения (connection-oriented). Гарантирует доставку (если пакет потерялся, он будет отправлен снова). Используется для веба, почты, файлов.
    2. **UDP (User Datagram Protocol):** Быстрый, но ненадежный (connection-less). Не проверяет доставку ("отправил и забыл"). Используется для видео, голоса, онлайн-игр.
        
- **Порты:** Использует номера портов (например, 80 для веб, 25 для почты), чтобы знать, какой программе передать данные.
- **Единица данных:** **Сегмент (Segment)** (для TCP) или Датаграмма (для UDP).
    

#### **Уровень 5: Сеансовый (Session Layer)**

- **Что делает:** Управляет сеансами связи (создает, поддерживает и разрывает соединение) между приложениями.
- **Функции:** Разделяет данные разных приложений, чтобы они не перепутались. Управляет режимами передачи (симплекс — в одну сторону, полудуплекс — по очереди, дуплекс — одновременно).
    

#### **Уровень 6: Представительский (Presentation Layer)**

- **Что делает:** "Переводчик". Заботится о том, чтобы данные были понятны получателю.
    
- **Функции:**
    
    - Кодирование символов (ASCII, EBCDIC).
    - Форматы файлов (JPEG, MP3).
    - **Шифрование** и дешифрование.
    - Сжатие данных.
        

#### **Уровень 7: Прикладной (Application Layer)**

- **Что делает:** Взаимодействует с пользователем и сетевыми приложениями. Это то, что мы видим (браузер, почтовый клиент).
    
- **Протоколы:**
    
    - **HTTP/HTTPS:** Веб-страницы.
    - **FTP:** Передача файлов.
    - **SMTP, POP3, IMAP:** Электронная почта.
    - **DNS:** Преобразование имен сайтов в IP-адреса.
    - **DHCP:** Автоматическая выдача IP-адресов.

---

## 2. Понимание модели TCP/IP

Модель **TCP/IP** (или модель DoD) старше и проще модели OSI. Она используется в реальном Интернете. В ней всего **4 уровня**, которые объединяют функции 7 уровней OSI.

|**Уровень TCP/IP**|**Соответствие OSI**|**Описание**|
|---|---|---|
|**4. Прикладной (Application)**|Прикладной, Представительский, Сеансовый|Все высокоуровневые протоколы (HTTP, DNS, FTP и т.д.).|
|**3. Транспортный (Transport)**|Транспортный|TCP и UDP. Управляет связью "хост-хост".|
|**2. Интернет (Internet)**|Сетевой|IP, ICMP, ARP. Маршрутизация и адресация.|
|**1. Канальный (Link/Network Interface)**|Канальный, Физический|Ethernet, Wi-Fi. Физическая передача данных.|

> _Примечание:_ Microsoft и некоторые учебники используют 4 уровня. Иногда выделяют 5 уровней, разделяя физический и канальный. Но классическая модель TCP/IP — это 4 уровня.

---

## 3. Инкапсуляция данных (Encapsulation)

Когда данные спускаются по уровням вниз (от пользователя в кабель), каждый уровень добавляет к ним свой заголовок. Этот процесс называется **инкапсуляцией**.

1. **Уровни 7-5 (Данные/PDU):** Пользователь пишет письмо.
2. **Уровень 4 (Сегмент):** Транспортный уровень добавляет порты и делит данные на куски.
3. **Уровень 3 (Пакет):** Сетевой уровень добавляет IP-адреса (отправителя и получателя).
4. **Уровень 2 (Кадр):** Канальный уровень добавляет MAC-адреса.
5. **Уровень 1 (Биты):** Всё превращается в 1 и 0 и уходит в провод.

На стороне получателя происходит обратный процесс — **декапсуляция** (снимаются заголовки, пока не останутся чистые данные).

---

## Ключевые выводы по Главе 3:

- Нужно знать порядок уровней OSI наизусть.
- **Коммутаторы (Switches)** работают на **Уровне 2** (Data Link) и используют MAC-адреса.
- **Маршрутизаторы (Routers)** работают на **Уровне 3** (Network) и используют IP-адреса.
- **Хабы (Hubs)** работают на **Уровне 1** (Physical) и просто транслируют сигнал.
- Разница между **TCP** (надежный, с соединением) и **UDP** (быстрый, без соединения) критична.

# Глава 4: Основные протоколы TCP/IP

В предыдущей главе мы разобрали модели OSI и TCP/IP. Теперь мы рассмотрим конкретные протоколы, которые работают на этих уровнях. Понимание протоколов — ключ к пониманию того, как работает сеть.

**Темы главы:**

- Понимание TCP и UDP
- Изучение распространенных протоколов (HTTP, FTP, SMTP и др.)
- Понимание портов
    

---

## Понимание TCP и UDP

Протоколы транспортного уровня (Transport Layer) отвечают за доставку данных между приложениями на двух компьютерах. Два главных конкурента здесь — это **TCP** и **UDP**.

### 1. Transmission Control Protocol (TCP)

TCP — это **протокол с установкой соединения (connection-oriented)**.

- **Гарантированная доставка:** Когда TCP отправляет данные, он требует подтверждения (ACK) от получателя. Если подтверждение не пришло, TCP отправляет данные снова.
- **Рукопожатие (Three-way handshake):** Прежде чем отправить данные, компьютеры «договариваются»:
    
    1. **SYN:** Компьютер А говорит: «Привет, хочу поговорить» (отправляет SYN-пакет).
    2. **SYN/ACK:** Компьютер Б отвечает: «Привет, я тебя слышу, давай говорить» (отправляет SYN/ACK).
    3. **ACK:** Компьютер А отвечает: «Отлично, начинаю передачу» (отправляет ACK).
        
- **Применение:** Веб-сайты (HTTP), электронная почта (SMTP), передача файлов (FTP) — везде, где потеря даже одного байта недопустима.
    

### 2. User Datagram Protocol (UDP)

UDP — это **протокол без установки соединения (connectionless)**.

- **Best effort («как получится»):** UDP просто выбрасывает данные в сеть, надеясь, что они дойдут. Он не ждет подтверждений и не переспрашивает.
- **Скорость:** Из-за отсутствия проверок UDP работает намного быстрее TCP.
- **Применение:** Потоковое видео (streaming), онлайн-игры, голосовая связь (VoIP). В этих случаях небольшая потеря данных (один выпавший кадр) не так страшна, как задержка.
    

> **Аналогия:**
> 
> - **TCP** — это заказное письмо с уведомлением о вручении. Вы точно знаете, получил ли его адресат.
> - **UDP** — это обычная открытка. Вы бросили её в ящик и надеетесь, что она дойдет, но гарантий нет.


---

## Изучение распространенных протоколов

Здесь описываются протоколы, с которыми вы будете сталкиваться ежедневно. Большинство из них работают на **Прикладном уровне (Application Layer)**, но используют TCP или UDP для транспорта.

### ARP (Address Resolution Protocol)

- **Проблема:** Компьютеры знают IP-адрес получателя (например, 192.168.1.5), но для передачи данных внутри локальной сети им нужен физический **MAC-адрес**.
- **Решение:** Компьютер посылает широковещательный запрос (Broadcast): «У кого IP 192.168.1.5?». Нужный компьютер отвечает своим MAC-адресом.
- **ARP Cache:** Чтобы не спрашивать каждый раз, компьютер запоминает пары IP-MAC в своей памяти (кэше).
- _Команда:_ `arp -a` (показывает текущий кэш ARP).
    

### HTTP и HTTPS

- **HTTP (Hypertext Transfer Protocol):** Используется для передачи веб-страниц. Текст передается в открытом виде (небезопасно).
- **HTTPS (HTTP Secure):** То же самое, но зашифровано с помощью протоколов SSL или TLS. Если вы вводите пароль или номер карты, убедитесь, что адрес начинается с `https://`.
    

### FTP и TFTP

- **FTP (File Transfer Protocol):** Используется для загрузки и скачивания файлов. Поддерживает аутентификацию (логин/пароль). Использует TCP.
- **TFTP (Trivial FTP):** Упрощенная версия для передачи маленьких файлов. Использует UDP. Часто используется для загрузки бездисковых станций по сети.
    

### Протоколы электронной почты

- **SMTP (Simple Mail Transfer Protocol):** Используется для **отправки** почты (от клиента на сервер или между серверами).
- **POP3 (Post Office Protocol v3):** Используется для **получения** почты. Скачивает письма с сервера на компьютер и (обычно) удаляет их с сервера.
- **IMAP (Internet Message Access Protocol):** Более современный протокол для **получения** почты. Письма хранятся на сервере, что позволяет видеть их с разных устройств (телефона, ноутбука).
    

### Протоколы удаленного доступа

- **Telnet:** Старый протокол для управления серверами через командную строку. **Опасен**, так как передает пароли в открытом виде.
- **SSH (Secure Shell):** Безопасная замена Telnet. Шифрует весь трафик. Используется администраторами Linux/Unix (и маршрутизаторов Cisco).
- **RDP (Remote Desktop Protocol):** Протокол Microsoft для подключения к удаленному рабочему столу (графический интерфейс).
    

### Сетевые сервисные протоколы

- **SNMP (Simple Network Management Protocol):** Используется администраторами для мониторинга сетевых устройств (роутеров, свитчей). Позволяет узнать загрузку сети, ошибки и т.д.
- **ICMP (Internet Control Message Protocol):** Служебный протокол для диагностики. Именно его использует команда `ping`, чтобы проверить доступность узла.
- **IGMP (Internet Group Multicast Protocol):** Управляет групповой передачей данных (Multicast), например, для онлайн-ТВ.
    

---

## Понимание портов (Understanding Ports)

Как компьютер понимает, какому приложению отдать пришедшие данные? Ведь по одному кабелю одновременно качается файл, открывается сайт и играет музыка.

Для этого используются **порты**.

**Порт** — это логический номер (от 0 до 65535), который идентифицирует конкретную службу или приложение.

Комбинация `IP-адрес : Порт` называется **сокетом** (socket).

- _Пример:_ Если IP — это адрес дома, то порт — это номер квартиры.
    

### Диапазоны портов

1. **Хорошо известные порты (Well-known ports):** 0 – 1023. Зарезервированы для основных служб (веб, почта и т.д.).
2. **Зарегистрированные порты (Registered ports):** 1024 – 49151. Используются приложениями (например, игры, SQL-серверы).
3. **Динамические порты (Dynamic/Private ports):** 49152 – 65535. Выдаются клиентам временно для исходящих соединений.
    

### Таблица важных портов (Нужно знать наизусть!)

|**Протокол**|**Порт**|**Описание**|
|---|---|---|
|**FTP**|20, 21|Передача файлов (21 - команды, 20 - данные)|
|**SSH**|22|Безопасная консоль (Secure Shell)|
|**Telnet**|23|Небезопасная консоль|
|**SMTP**|25|Отправка почты|
|**DNS**|53|Преобразование имен в IP (UDP/TCP)|
|**HTTP**|80|Веб-сайты (незащищенный)|
|**POP3**|110|Получение почты (старый)|
|**IMAP**|143|Получение почты (новый)|
|**HTTPS**|443|Веб-сайты (защищенный SSL)|
|**RDP**|3389|Удаленный рабочий стол Windows|

---

## Основные выводы (The Essentials)

- **TCP** надежен (проверяет доставку), **UDP** быстр (отправляет и забывает).
- **ARP** находит MAC-адрес по IP-адресу.
- **HTTP (80)** и **HTTPS (443)** — основа Веба.
- **SMTP (25)** отправляет почту, **POP3 (110)** и **IMAP (143)** принимают её.
- **Порты** позволяют компьютеру разделять трафик разных приложений. Диапазон "Well-known" — от 0 до 1023.


# Глава 5: Изучение IPv4 (Exploring IPv4)

IPv4-адреса — это основной тип адресов, используемых сегодня в Интернете и во внутренних сетях. Понимание того, из чего состоит IP-адрес, критически важно для настройки сети и устранения неполадок.

**Темы главы:**

- Изучение компонентов адреса IPv4
- Представление IPv4-адреса в двоичном виде
- Разделение сетей на подсети (Subnetting)
- Сравнение ручного и автоматического назначения адресов
    

---

## 1. Изучение компонентов адреса IPv4

Когда вы смотрите на настройки TCP/IP (например, командой `ipconfig`), вы видите три ключевых параметра. Чтобы компьютер мог работать в сети, все они должны быть настроены правильно.

### IP-адрес (IP Address)

Это уникальный идентификатор компьютера в сети.

- IPv4-адрес — это **32-битное** число.
- Для удобства людей оно записывается в **десятичном формате с точками** (dotted decimal format): четыре числа от 0 до 255, разделенные точками (например, `192.168.1.5`).
- Компьютеры же видят это как набор нулей и единиц (например, `11000000.10101000.00000001.00000101`).
    

### Маска подсети (Subnet Mask)

Маска подсети говорит компьютеру, какая часть IP-адреса относится к **сети (Network ID)**, а какая — к самому **компьютеру (Host ID)**.

- Типичная маска: `255.255.255.0`.
- Если маска `255.255.255.0`, то первые три числа IP-адреса (`192.168.1`) — это адрес улицы (сети), а последнее число (`5`) — это номер дома (компьютера).
- Компьютер использует маску, чтобы понять: находится ли собеседник в _той же_ локальной сети (можно отправить напрямую) или в _другой_ (нужно отправлять через шлюз).
    

### Шлюз по умолчанию (Default Gateway)

Это IP-адрес маршрутизатора (роутера), который соединяет вашу сеть с другими сетями (или Интернетом).

- Если компьютер хочет отправить данные в Интернет (например, на https://www.google.com/search?q=Google.com), он отправляет их на адрес Шлюза по умолчанию.
- Если это поле оставить пустым, компьютер сможет общаться только с соседями по локальной сети, но не выйдет в Интернет.
    

---

## 2. IPv4-адрес в двоичном виде (Binary)

Люди используют десятичную систему (0-9), а компьютеры — двоичную (0-1). Понимание двоичной системы необходимо для понимания того, как работают подсети.

**Бит (Bit):** Одна цифра, 0 или 1.

**Байт (Byte) или Октет:** Группа из 8 битов. IP-адрес состоит из 4 октетов (всего 32 бита).

### Как читать биты

Каждый бит в октете имеет свой "вес" в зависимости от позиции (степени двойки):

`128 | 64 | 32 | 16 | 8 | 4 | 2 | 1`

_Пример:_ Число **192** в двоичном виде — это `11000000`.

- Расчет: 128 + 64 + 0 + ... = 192.
    
    _Пример:_ Число **168** — это `10101000`.
    
- Расчет: 128 + 32 + 8 = 168.
    

> **Зачем это знать?**
> 
> Когда вы видите маску `/24` или `/26`, это означает количество единиц в двоичном представлении маски. Компьютер накладывает эту маску на IP-адрес (логическая операция AND), чтобы вычислить ID сети.

---

## 3. Разделение на подсети (Subnetting)

Изначально IP-адреса делились на классы (A, B, C). Это называется **классовая адресация** (Classful).

### Классы IP-адресов

|**Класс**|**Диапазон (1-й октет)**|**Маска по умолчанию**|**Назначение**|
|---|---|---|---|
|**Class A**|1 – 126|255.0.0.0 (/8)|Огромные сети (16 млн узлов).|
|**Class B**|128 – 191|255.255.0.0 (/16)|Средние сети (65 тыс. узлов).|
|**Class C**|192 – 223|255.255.255.0 (/24)|Малые сети (254 узла).|

> _Примечание:_ Адрес `127.x.x.x` пропущен, так как он зарезервирован для **Loopback** (тестирование сетевой карты на самом себе, `127.0.0.1`).

### Бесклассовая адресация (CIDR)

Классовая система была неэффективной (тратилось много адресов впустую). Сейчас используется **CIDR** (Classless Inter-Domain Routing).

В CIDR маска может быть любой длины, а не только /8, /16 или /24. Она записывается через слэш.

- **192.168.1.0/24** — Стандартная сеть (254 хоста).
- **192.168.1.0/25** — Сеть разделена пополам (126 хостов).
- **192.168.1.0/26** — Сеть разделена на 4 части (62 хоста).
    

**Subnetting (Сабнеттинг)** — это процесс заимствования битов у части Host ID для создания дополнительных подсетей. Это позволяет администраторам разделять большие сети на маленькие, изолированные сегменты для безопасности и производительности.

---

## 4. Сравнение ручного и автоматического назначения адресов

Как компьютер получает свой IP-адрес?

### 1. Статическая адресация (Static / Manual)

Администратор вручную вводит IP-адрес, маску, шлюз и DNS на каждом компьютере.

- **Плюсы:** Адрес никогда не меняется (хорошо для серверов и принтеров).  
- **Минусы:** Трудоемко. Если ошибиться и дать двум ПК один адрес — будет конфликт IP. Если нужно поменять DNS, придется бегать ко всем компьютерам.

### 2. Динамическая адресация (DHCP)

Используется протокол **DHCP (Dynamic Host Configuration Protocol)**.

- **Как это работает (DORA):**
    
    1. **D**iscover: Компьютер включается и кричит: "Есть кто живой? Мне нужен адрес!"
    2. **O**ffer: Сервер отвечает: "Я могу предложить тебе адрес 192.168.1.50".
    3. **R**equest: Компьютер: "Беру! Запиши его на меня".
    4. **A**cknowledge: Сервер: "Договорились. Вот твои настройки (маска, шлюз, DNS)".
- **Плюсы:** Все происходит автоматически. Исключены ошибки и дубликаты. Легко менять настройки всей сети.
    

### 3. APIPA (Automatic Private IP Addressing)

Что если компьютер настроен на DHCP, но сервер сломался или недоступен?

Компьютер назначает себе адрес сам из диапазона **169.254.x.x**.

- **Симптом:** Если вы видите у себя адрес, начинающийся на `169.254...`, это значит, что сеть сломана (DHCP-сервер не ответил).
- С таким адресом вы можете общаться с соседями (у которых тоже APIPA), но **Интернета не будет**, так как нет Шлюза по умолчанию.
    

---

## Основные выводы (The Essentials)

- **IPv4-адрес** состоит из 32 бит (4 октета).
- **Маска подсети** определяет границы сети.
- **Шлюз по умолчанию** нужен для доступа в другие сети и Интернет.
- **DHCP** автоматизирует раздачу адресов.
- **APIPA (169.254.x.x)** выдается автоматически, если DHCP недоступен; доступ в Интернет с ним не работает.
- **CIDR** (например, /24) — современный способ записи маски подсети.


# Глава 6: Изучение IPv6 (Exploring IPv6)

Хотя IPv4 служит нам верой и правдой уже много лет, его адреса заканчиваются. На сцену выходит IPv6. Он не просто "немного больше", он работает совсем по-другому. Даже опытные специалисты по IPv4 должны учить IPv6 практически с нуля.

**Темы главы:**

- Понимание адресов IPv6
- Изучение компонентов адреса IPv6
- Понимание работы двойного стека (Dual IP Stack)
- Сравнение ручного и автоматического назначения IPv6

---

## 1. Понимание адресов IPv6

Главная причина перехода на IPv6 — **нехватка адресов**.

- **IPv4:** 32 бита = ~4.3 миллиарда адресов. Население Земли уже больше 7 миллиардов, плюс у каждого телефон, ноутбук, умные часы...
- **IPv6:** 128 бит = $3.4 \times 10^{38}$ адресов. Это число с 38 нулями.
    - _Аналогия:_ Если IPv4 — это размер мячика для гольфа, то IPv6 — это размер Солнца. Адресов хватит, чтобы присвоить IP каждому атому на поверхности Земли.
        

### Формат записи (Шестнадцатеричный)

IPv6-адреса слишком длинные для десятичной записи, поэтому используется **шестнадцатеричная система (Hexadecimal)**.

- Адрес состоит из **8 групп** по 4 символа (хекстетов), разделенных двоеточиями.
- _Пример:_ `2001:0db8:0000:0000:0000:ff00:0042:8329`
    

**Правила сокращения (Zero Compression):**

Чтобы не писать такую длинную строку, можно её сократить:

1. **Удаление ведущих нулей:** `0042` превращается в `42`. `0db8` -> `db8`.
2. **Двойное двоеточие (::):** ОДИН раз в адресе можно заменить длинную цепочку нулей на `::`.
    
    - _Было:_ `2001:db8:0:0:0:ff00:42:8329`
    - _Стало:_ `2001:db8::ff00:42:8329`
    - _Важно:_ Нельзя использовать `::` дважды (компьютер не поймет, сколько нулей спрятано в каждом месте).
        

---

## 2. Изучение компонентов адреса IPv6

В IPv6 нет масок подсети в привычном виде (как 255.255.255.0). Вместо этого используется **префикс** (Prefix notation, CIDR).

Типичный адрес делится пополам (/64):

1. **Префикс сети (Network Prefix):** Первые 64 бита. Определяют сеть (аналог Network ID в IPv4). Обычно выдаются провайдером.
2. **Идентификатор интерфейса (Interface ID):** Последние 64 бита. Уникальный номер устройства (аналог Host ID).

### Типы адресов IPv6

В IPv6 **НЕТ** широковещательных адресов (Broadcast). Вместо этого используются:

1. **Unicast (Одноадресный):** Один получатель.
    - **Global Unicast:** Публичный адрес для Интернета (обычно начинается с `2...` или `3...`).
    - **Link-Local:** Работает _только_ в пределах одного кабеля/сегмента (как APIPA 169.254.x.x). Всегда начинается с **`fe80::`**. Каждый интерфейс с IPv6 _обязан_ иметь Link-Local адрес.
    - **Unique Local:** Аналог частных сетей (192.168.x.x). Начинается с `fc00::` или `fd00::`. Не маршрутизируется в Интернет.
        
2. **Multicast (Многоадресный):** Один отправитель — группа получателей. Начинается с **`ff...`**.
    - Заменяет Broadcast. Если нужно найти кого-то, отправляется запрос на специальный мультикаст-адрес.
    
3. **Anycast (Произвольный):** Один адрес присвоен _группе_ серверов. Пакет доставляется **ближайшему** из них.
    - _Пример:_ DNS-серверы Google (8.8.8.8) на самом деле работают через Anycast. Вы попадаете на ближайший к вам сервер.

---

## 3. Понимание двойного стека (Dual IP Stack)

Мы не можем просто выключить IPv4 и включить IPv6 за один день. Поэтому используется переходный период.

**Dual Stack (Двойной стек):**

Операционная система (Windows 7/10/11) запускает оба протокола одновременно. Компьютер имеет и IPv4, и IPv6 адреса.

- Если сайт поддерживает IPv6 (например, Google), компьютер использует IPv6.
- Если сайт старый (только IPv4), используется IPv4.
    

### Технологии туннелирования (Tunneling)

Позволяют передавать IPv6 пакеты через старые IPv4 сети.

1. **Teredo:** Позволяет IPv6 проходить через NAT (домашние роутеры). Часто включен по умолчанию в Windows.
2. **ISATAP:** Используется внутри корпоративных сетей.
3. **6to4:** Более старый метод, требует публичного IPv4.
    

> _Примечание:_ Если вы видите в `ipconfig` кучу "Tunnel Adapter...", это работают эти протоколы.

---

## 4. Сравнение ручного и автоматического назначения IPv6

Как и в IPv4, адреса можно вбить вручную или получить автоматически, но в IPv6 автоматика намного умнее.

### DHCPv6

Работает похоже на обычный DHCP. Сервер выдает адрес и настройки.

### SLAAC (Stateless Address Autoconfiguration)

Это магия IPv6. Компьютер может настроить себя сам **без DHCP-сервера**.

1. **Запрос (Router Solicitation):** Компьютер при включении спрашивает: "Здесь есть роутеры?"
2. **Ответ (Router Advertisement):** Роутер отвечает: "Да, я здесь. Префикс нашей сети — `2001:db8:1::`".
3. **Генерация ID:** Компьютер берет префикс сети и добавляет к нему свой уникальный Interface ID (часто генерируется на основе MAC-адреса).
4. **Готово:** У компьютера есть полный, рабочий адрес.
    

---

## Основные выводы (The Essentials)

- **128 бит:** Длина адреса IPv6.
- **Hexadecimal:** Используются цифры 0-9 и буквы A-F.
- **:: (Double Colon):** Сокращает цепочку нулей (только один раз в адресе).
- **Link-Local (`fe80::`):** Обязательный адрес для связи в локальной сети. Есть у каждого адаптера.
- **Global Unicast:** Публичный адрес для Интернета.
- **Loopback:** В IPv6 это просто `::1` (вместо 127.0.0.1).
- **Нет Broadcast:** Используется Multicast.

# Глава 7: Подключение компьютеров к сети (Connecting Computers to a Network)

Хотя подключение компьютера часто сводится к простому втыканию кабеля, "под капотом" скрывается много нюансов. Различные помехи могут испортить передачу данных. В этой главе мы узнаем о типах кабелей, беспроводных стандартах и инструментах для работы с ними.

**Темы главы:**

- Понимание средств передачи данных (кабели и радиоволны)
- Сравнение типов кабелей (Витая пара, Коаксиал, Оптоволокно)
- Понимание беспроводных сетей (Wi-Fi)
    

---

## 1. Понимание средств передачи данных (Transmission Media)

Когда данные летят по проводу, с ними могут случиться неприятности. Вот основные термины, которые нужно знать:

### Затухание (Attenuation)

Сигнал слабеет по мере прохождения по кабелю. Представьте, что вы кричите другу: чем дальше он стоит, тем тише ваш голос.

- Если кабель слишком длинный, сигнал "затухнет" и станет нечитаемым.
- Для усиления сигнала используются **повторители (repeaters)** или коммутаторы.
    

### Помехи (Interference)

Внешние сигналы могут вмешиваться в ваш кабель и портить данные.

1. **EMI (Electromagnetic Interference):** Электромагнитные помехи. Источники: моторы, генераторы, люминесцентные лампы, линии электропередач.
2. **RFI (Radio Frequency Interference):** Радиочастотные помехи. Источники: микроволновки, беспроводные телефоны, другие радиоустройства.
3. **Перекрестные помехи (Crosstalk):** Когда сигнал из одного провода "перепрыгивает" на соседний провод внутри одного кабеля.
    - _Решение:_ Скручивание проводов (витая пара) помогает гасить эти помехи.

---

# Глава 8: Объединение компьютеров с помощью коммутаторов (Networking Computers with Switches)

Коммутаторы (Switches) — это важнейший компонент любой проводной сети. Когда-то они были роскошью, но теперь полностью вытеснили хабы (Hubs) благодаря своим возможностям.

**Темы главы:**

- Понимание работы коммутаторов
- Сравнение управляемых и неуправляемых коммутаторов
- Сравнение коммутаторов 2-го и 3-го уровня
- Понимание безопасности коммутаторов
    

---

## 1. Понимание работы коммутаторов

Коммутатор работает на **Уровне 2 (Канальный)** модели OSI. Его главная задача — пересылать данные **только** нужному получателю, а не всем подряд (как это делали хабы).

### Как коммутатор "учится"? (Switching Learning Process)

Коммутатор строит и хранит в памяти **Таблицу MAC-адресов** (MAC Address Table).

1. **Обучение (Learning):**
    - Компьютер А (Порт 1) отправляет данные Компьютеру Б.
    - Коммутатор видит входящий кадр на Порту 1 и запоминает: _"Ага, MAC-адрес Компьютера А находится на Порту 1"_. Он записывает это в таблицу.
        
2. **Пересылка (Forwarding):**
    - Коммутатор смотрит на адрес получателя (Компьютер Б).
    - Если адрес Б уже есть в таблице (например, на Порту 5), коммутатор отправляет данные **только** на Порт 5.
        
3. **Заполнение (Flooding):**
    - Если адрес Б **неизвестен** (нет в таблице), коммутатор работает как хаб: он отправляет данные на **все** порты, кроме источника. Когда Компьютер Б ответит, коммутатор запомнит и его порт.
        

### Домены коллизий (Collision Domains)

- **В хабе:** Вся сеть — это один большой домен коллизий. Если двое говорят одновременно, данные портятся.
- **В коммутаторе:** Каждый порт — это **отдельный** домен коллизий.
    - Это позволяет использовать **Full Duplex** (одновременная передача и прием). В хабах возможен только Half Duplex.
    - Результат: Скорость сети и пропускная способность резко возрастают.
        

---

## 2. Управляемые и неуправляемые коммутаторы

### Неуправляемые коммутаторы (Unmanaged Switches)

- "Plug and Play". Вы просто втыкаете их в розетку и подключаете кабели.
- Нет интерфейса настройки, нет IP-адреса.
- Дешевые, идеальны для дома и очень малых офисов.
- **Минус:** Нельзя настроить VLAN, нельзя посмотреть статистику ошибок.
    

### Управляемые коммутаторы (Managed Switches)

- Имеют свой IP-адрес. Администратор может зайти на веб-интерфейс или подключиться через консоль (SSH/Telnet).
    
- Позволяют:
    
    - Создавать **VLAN**.
    - Ограничивать скорость на портах.
    - Настраивать безопасность (Port Security).
    - Следить за трафиком (Monitoring).
    - Объединять порты для увеличения скорости (Port Bonding / LACP).
        

---

## 3. Скорости и возможности передачи

1. **Uplink (Аплинк):** Специальный порт для подключения к другому коммутатору или роутеру. Обычно он быстрее остальных портов (например, 24 порта по 100 Мбит и 2 аплинка по 1 Гбит).
2. **Агрегация каналов (Link Aggregation / LACP):**
    - Можно объединить несколько физических кабелей в один логический канал.
    - _Пример:_ 4 кабеля по 1 Гбит/с = канал 4 Гбит/с.
    - Это повышает скорость и надежность (если один кабель порвется, остальные работают).
        

---

## 4. Понимание VLAN (Virtual LAN)

VLAN — это технология, позволяющая логически разделить один физический коммутатор на несколько изолированных сетей.

**Пример:** У вас один коммутатор на 24 порта.

- Порты 1-10: **VLAN 10** (Бухгалтерия).
- Порты 11-20: **VLAN 20** (Менеджеры).
- Компьютеры из Бухгалтерии **не увидят** компьютеры Менеджеров, как будто они подключены к разным свитчам. Связь между ними возможна только через маршрутизатор.
    

**Зачем нужны VLAN?**

1. **Безопасность:** Изоляция чувствительных отделов.
2. **Производительность:** Уменьшение широковещательного трафика (Broadcast домены разделены).
3. **Организация:** Можно группировать пользователей по отделам, а не по тому, где они сидят физически.
    

---

## 5. Коммутаторы 2-го и 3-го уровня (Layer 2 vs Layer 3)

- **Layer 2 Switch:** Обычный коммутатор. Работает только с MAC-адресами. Не понимает IP-адреса. Для связи между VLAN нужен внешний роутер.
    
- **Layer 3 Switch:** "Умный" коммутатор. Умеет выполнять функции маршрутизации.
    - Понимает IP-адреса и подсети.
    - Может сам пересылать данные между разными VLAN **без** внешнего роутера. Это работает намного быстрее, чем через обычный роутер.

---

## 6. Безопасность коммутаторов (Switch Security)

Злоумышленник, подключившийся к офисной розетке, может натворить бед. Как защититься?

### Port Security (Безопасность порта)

Позволяет ограничить, какие компьютеры могут подключаться к конкретному порту.

1. **MAC Address Filtering:** Вы прописываете, что к Порту 5 может подключиться только компьютер с MAC-адресом `AA:BB:CC...`. Если подключится другой — порт отключится.
2. **Ограничение количества:** Можно разрешить только 1 MAC-адрес на порт. Это запрещает пользователям приносить из дома свои хабы и подключать кучу устройств в одну розетку.
    

### Физическая безопасность

Если злоумышленник имеет физический доступ к коммутатору, он может сбросить пароль. Коммутаторы должны стоять в запертых шкафах или серверных комнатах.

---

## Основные выводы (The Essentials)

- **Коммутаторы (Switches)** используют таблицу MAC-адресов для прямой доставки данных.
- **VLAN** разделяют сеть на логические сегменты для безопасности и уменьшения трафика.
- **Layer 3 Switch** может маршрутизировать трафик между VLAN.
- **Port Security** защищает сеть от несанкционированных подключений по MAC-адресу.
- **Full Duplex** удваивает пропускную способность (одновременный прием и передача).

# Глава 9: Соединение сетей с помощью маршрутизаторов

Если коммутаторы (свитчи) соединяют компьютеры _внутри_ одной сети, то маршрутизаторы (роутеры) соединяют _разные_ сети между собой.

В DevOps это встречается везде: связь между контейнерами, связь офиса с облаком, связь микросервисов.

### 1. Что делает маршрутизатор?

Маршрутизатор работает на **3-м уровне (Сетевом)** модели OSI. Его главная задача — пересылать пакеты из одной подсети в другую, выбирая лучший путь.

- **Разделение широковещательных доменов:** Роутеры _не пропускают_ Broadcast-трафик. Это не дает "шуму" из одной сети засорять другую.
- **Шлюз по умолчанию (Default Gateway):** Это IP-адрес роутера в вашей подсети. Компьютер отправляет туда все пакеты, предназначенные для "чужих" сетей (например, в Интернет).
    

### 2. Таблицы маршрутизации (Routing Tables)

У каждого роутера (и даже у твоего Linux-сервера) есть таблица маршрутизации. Это "карта", по которой он решает, куда слать пакет.

Запись в таблице обычно содержит:

1. **Сеть назначения (Destination):** Куда хотим попасть (например, `10.0.0.0/24`).
2. **Шлюз (Gateway / Next Hop):** IP-адрес следующего роутера, которому нужно передать эстафету.
3. **Интерфейс (Interface):** Порт, через который нужно выплюнуть пакет.
4. **Метрика (Metric):** "Цена" пути. Если есть два пути, роутер выберет тот, где метрика меньше (где путь быстрее или короче).
    

> **В Linux:** Посмотреть таблицу можно командой `ip route` или старой `route -n`.

### 3. Статическая и Динамическая маршрутизация

**Статическая маршрутизация (Static Routing):** Администратор вручную прописывает каждый маршрут: _"Чтобы попасть в сеть B, иди на роутер 2"_.

- **Плюсы:** Безопасно, предсказуемо, не тратит ресурсы процессора.
- **Минусы:** Если кабель порвется, роутер продолжит слать пакеты в пустоту. В больших сетях админ сойдет с ума прописывать всё вручную.
    

**Динамическая маршрутизация (Dynamic Routing):** Роутеры общаются друг с другом по специальным протоколам и сами строят карту сети.

- _"Привет, я роутер А, через меня можно попасть в сеть 1 и 2"._
- _"Привет, я роутер Б, а через меня — в сеть 3"._ Если путь отвалится, они автоматически перестроят маршрут.
    

**Популярные протоколы (нужно знать названия):**

1. **RIP (Routing Information Protocol):** Древний, простой. Выбирает путь по количеству "прыжков" (hops). Максимум 15 прыжков. Сейчас используется редко (RIPv2).
2. **OSPF (Open Shortest Path First):** Самый популярный в корпоративных сетях. Учитывает скорость канала (линка). Если есть гигабитный канал и медленный модем, он выберет гигабит, даже если там больше прыжков.
3. **BGP (Border Gateway Protocol):** **Самый главный протокол Интернета.** Именно он соединяет провайдеров и страны. Работает медленно, но масштабируется на весь мир.
    

### 4. NAT (Network Address Translation)

Это критически важная тема для DevOps (Docker использует NAT). В IPv4 адресов мало. NAT позволяет спрятать всю офисную (или домашнюю) сеть за **одним** публичным IP-адресом.

**Как это работает (PAT - Port Address Translation):**

1. Твой компьютер (`192.168.1.5`) хочет открыть Google.
2. Пакет уходит на роутер.
3. Роутер подменяет твой внутренний IP (`192.168.1.5`) на свой внешний публичный IP (`80.80.80.80`) и назначает уникальный **порт** (например, 50001).
4. В таблицу NAT записывается: _"Всё, что придет на порт 50001, пересылать на 192.168.1.5"_.
5. Google отвечает на `80.80.80.80:50001`.
6. Роутер смотрит в таблицу, меняет адрес обратно и отдает пакет тебе.
    

> **Важно:** Без настройки проброса портов (Port Forwarding), никто из Интернета не может сам начать соединение с твоим компьютером за NAT. Это дает базовую безопасность.

---

### Контрольные выводы для Linux-инженера:

1. **Шлюз по умолчанию:** Если пинг в Интернет не идет, проверь `ip route`. Есть ли там строка `default via ...`?
2. **NAT:** Контейнеры Docker часто имеют свои IP (например, `172.17.0.2`), но выходят в мир через NAT хоста.
3. **Таблица маршрутизации:** Роутер всегда выбирает **наиболее специфичный маршрут** (Longest Prefix Match). Если есть маршрут на `0.0.0.0/0` (весь интернет) и маршрут на `10.0.0.0/8`, то пакет для `10.0.0.1` пойдет по второму, так как он точнее.

# Глава 10: Разрешение имен в IP-адреса (Resolving Names to IP Addresses)

В предыдущих главах мы узнали, что компьютеры используют IP-адреса для связи. Но люди не любят запоминать числа вроде `172.217.16.142`. Нам удобнее запомнить `google.com`. Процесс превращения понятного человеку имени в понятный компьютеру IP-адрес называется **разрешением имен (Name Resolution)**.

**Темы главы:**

- Типы имен в сетях (Host Names vs NetBIOS)
- Файл Hosts
- DNS (Domain Name System)
- WINS (Windows Internet Naming Service)
- Процесс разрешения имен
    

---

## 1. Типы имен, используемых в сетях

Исторически сложилось два типа имен:

1. **Host Names (Имена хостов):** Используются в Интернете и в большинстве современных сетей (Linux/Unix/Windows).
    
    - Это часть иерархической системы (DNS).
    - Длина до 255 символов.
    - Могут содержать буквы, цифры и дефисы.
    - _Пример:_ `www.google.com` (FQDN — Fully Qualified Domain Name).
        
2. **NetBIOS Names:** Старый формат Microsoft для локальных сетей.
    
    - Плоская структура (нет иерархии).
    - Длина ровно 16 символов (15 для имени + 1 служебный байт).
    - Сейчас используется редко, в основном для поддержки очень старого софта.
        

> **Для DevOps важны только Host Names и DNS.**

---

## 2. Файл Hosts

До появления DNS вся карта Интернета хранилась в одном текстовом файле на каждом компьютере. Этот файл существует до сих пор и имеет **высший приоритет**.

**Расположение:**

- **Windows:** `C:\Windows\System32\drivers\etc\hosts`
- **Linux:** `/etc/hosts`
    

**Формат:**

Plaintext

```
127.0.0.1       localhost
192.168.1.10    server1.local
```

**Зачем он нужен DevOps-инженеру?**

1. **Тестирование:** Ты поднял веб-сайт на новом сервере, но еще не купил домен. Ты прописываешь IP и домен в `/etc/hosts` на своем ноутбуке, и для тебя сайт открывается по имени, как будто он уже в Интернете.
2. **Блокировка:** Можно заблокировать доступ к сайтам, перенаправив их на `127.0.0.1` (так работают блокировщики рекламы).
    

---

## 3. DNS (Domain Name System)

DNS — это телефонная книга Интернета. Она иерархична и распределена по всему миру.

### Структура имени (FQDN)

Имя `www.microsoft.com` читается справа налево:

1. **. (Root):** Корневой уровень (обычно не пишется, но подразумевается в конце).
2. **.com:** Домен верхнего уровня (Top-Level Domain, TLD). Управляется организацией IANA.
3. **.microsoft:** Домен второго уровня. Покупается компанией.
4. **www:** Имя хоста (конкретного сервера) в этом домене.
    

### Типы DNS-записей (Критически важно знать!)

В таблицах DNS хранятся записи разных типов. Вот самые важные:

1. **A (Host Record):** Самая главная запись. Связывает имя с **IPv4** адресом.
    - _Пример:_ `google.com` -> `142.250.185.78`
        
2. **AAAA (IPv6 Host Record):** То же самое, но для **IPv6**.
    - _Пример:_ `google.com` -> `2001:4860:4860::8888`
        
3. **CNAME (Alias / Псевдоним):** Одно имя ссылается на _другое имя_.
    - _Пример:_ `ftp.mysite.com` -> `www.mysite.com`. Если поменять IP у `www`, то `ftp` обновится автоматически.
        
4. **MX (Mail Exchanger):** Указывает, какой сервер принимает **электронную почту** для этого домена.
    - Без MX-записи почта ходить не будет.
        
5. **PTR (Pointer):** Обратная запись. Связывает IP-адрес с именем (для обратного поиска).
6. **SOA (Start of Authority):** Содержит информацию о самой зоне DNS (кто администратор, как часто обновляться).
    

### Зоны DNS

- **Forward Lookup Zone (Зона прямого просмотра):** Превращает Имена в IP.
- **Reverse Lookup Zone (Зона обратного просмотра):** Превращает IP в Имена (нужно для безопасности почтовых серверов и диагностики).
    

---

## 4. Процесс разрешения имен (Как это работает пошагово)

Когда ты вводишь `http://server1` в браузере, компьютер ищет IP в таком порядке:

1. **Локальный кэш DNS:** "Я недавно туда заходил? Если да, то вот адрес из памяти".
    - _Команда:_ `ipconfig /displaydns` (Windows).
        
2. **Файл Hosts:** "Проверю файл `/etc/hosts`. Может, админ прописал что-то вручную?"
    
3. **DNS-сервер:** Компьютер отправляет запрос на сервер, указанный в сетевых настройках (обычно 8.8.8.8 или сервер провайдера).
    - Если этот сервер не знает ответа, он спрашивает у вышестоящих серверов (Root -> .com -> .google...), пока не найдет ответ.
        
4. **NetBIOS (WINS / Broadcast):** Если это Windows-сеть и DNS не сработал, компьютер может попытаться "прокричать" имя в локальную сеть (Broadcast). В Linux это обычно отключено.
    

### LLMNR (Link-Local Multicast Name Resolution)

Современный протокол (есть в Windows и Linux через systemd-resolved), который позволяет компьютерам в одной подсети находить друг друга по именам _без_ DNS-сервера. Работает через Multicast.

---

## 5. Инструменты диагностики (DevOps Toolkit)

Как понять, почему сайт не открывается?

1. **ipconfig /flushdns** (Windows) / `systemd-resolve --flush-caches` (Linux):
    - Очищает локальный кэш. Полезно, если вы поменяли IP на сервере, а компьютер всё еще ломится на старый адрес.
        
2. **nslookup (Name Server Lookup):**
    - Старая, но надежная утилита для проверки DNS.
    - _Пример:_ `nslookup google.com` покажет IP-адрес.
    - _Пример:_ `nslookup` -> `set type=mx` -> `gmail.com` покажет почтовые серверы.
        
3. **dig (Domain Information Groper):**
    - **Стандарт в Linux.** Мощнее, чем nslookup. Показывает весь путь запроса.
    - _Пример:_ `dig google.com`
        

---

## Основные выводы (The Essentials)

- **Host Names** используются в DNS и Интернете.
- **Файл Hosts** имеет приоритет над DNS. Используется для тестов и переопределения.
- **Запись A** = Имя в IPv4.
- **Запись AAAA** = Имя в IPv6.
- **Запись CNAME** = Имя в Имя (псевдоним).
- **Запись MX** = Для почты.
- **Кэширование:** Компьютеры запоминают ответы DNS. Если что-то поменялось, кэш нужно сбросить (`flushdns`).
    

---

# Глава 14: Устранение неполадок TCP/IP (Troubleshooting TCP/IP)

Одна из главных причин изучать сети — умение их чинить. Когда пользователь говорит "Интернет не работает", это может означать что угодно: от выдернутого кабеля до падения DNS-сервера в другой стране. Чтобы найти причину, нужно использовать специальные утилиты командной строки.

**Темы главы:**

- Использование командной строки (Command Prompt)
- Проверка конфигурации с `ipconfig`
- Проверка связи с `ping`
- Определение маршрутизаторов с `tracert` (Trace Route)
- Проверка пути с `pathping`
- Просмотр статистики с `netstat`
- Использование Telnet
    

---

## 1. Командная строка (The Command Prompt)

Все инструменты диагностики работают через текстовый интерфейс.

- **Windows:** Запускается через `cmd.exe`.
- **Linux:** Твой основной терминал (bash/zsh).
    

> **Важно:** Многие команды требуют прав администратора. В Windows это "Run as Administrator", в Linux — `sudo`.

---

## 2. Проверка конфигурации (ipconfig)

Первый шаг в любой диагностике — понять, кто я и какие у меня настройки.

### ipconfig (Windows) / ip addr (Linux)

Команда показывает текущие настройки IP.

- **`ipconfig`**: Показывает кратко (IP, маску, шлюз).
- **`ipconfig /all`**: Показывает **всё**:
    
    - MAC-адрес (Physical Address).
    - Адрес DHCP-сервера (кто выдал IP).
    - Адреса DNS-серверов.
    - Время аренды IP (Lease Obtained / Expires).
        

**Полезные ключи:**

- `ipconfig /release` — Отказаться от текущего IP (вернуть его серверу).
- `ipconfig /renew` — Попросить новый IP у DHCP-сервера (помогает, если сеть "зависла").
- `ipconfig /flushdns` — Очистить кэш DNS.
    

> **Аналоги в Linux:**
> 
> - `ip addr show` (современный стандарт).
>     
> - `ifconfig` (устаревший, но часто встречается).
>     
> - `resolvectl flush-caches` (для сброса DNS в systemd).
>     

---

## 3. Проверка связи (ping)

Самый известный инструмент. Проверяет, "жив" ли удаленный компьютер и есть ли к нему доступ. Использует протокол **ICMP** (Echo Request / Echo Reply).

**Как это работает:** Вы пишете `ping google.com`. Ваш компьютер шлет 4 маленьких пакета. Если сервер отвечает, вы видите время отклика (например, `time=14ms`).

**Что искать в выводе:**

1. **Reply from...**: Всё хорошо, связь есть.
2. **Request timed out**: Сервер не ответил. Либо он выключен, либо где-то обрыв кабеля, либо (чаще всего) **Firewall** блокирует ICMP-пакеты.
3. **Destination host unreachable**: Ваш компьютер даже не знает, куда слать пакет (нет маршрута или шлюза).
    

**Ключи:**

- `-t` (Windows): Пинговать бесконечно, пока не нажмешь Ctrl+C. (В Linux это по умолчанию).
- `-a`: Попробовать узнать имя компьютера по IP-адресу.
    

> **Совет DevOps:** Если пинг не проходит, это не значит, что сервер лежит. Многие админы специально отключают ответы на Ping ради безопасности. Проверяй доступность порта (об этом ниже).

---

## 4. Определение маршрута (tracert)

Команда показывает **путь**, который проходит пакет от вас до сервера. Она показывает каждый роутер (прыжок / hop) на этом пути.

- **Windows:** `tracert google.com`
- **Linux:** `traceroute google.com` (иногда `tracepath`).
    

**Зачем это нужно?** Если сайт не открывается, `tracert` покажет, **где именно** обрывается связь.

- Если обрыв на 1-м шаге — проблема у вас (роутер).
- Если на 3-м шаге — проблема у провайдера.
- Если на последнем — проблема на сервере сайта.
    

**Как это работает:** Утилита шлет пакеты с разным "сроком жизни" (TTL).

- TTL=1: Умирает на 1-м роутере. Роутер шлет ошибку "Time Exceeded". Мы узнаем IP 1-го роутера.
- TTL=2: Умирает на 2-м роутере. И так далее.
    

---

## 5. PathPing (Только Windows)

Гибрид `ping` и `tracert`. Сначала строит маршрут, а потом "долбит" каждый роутер пакетами в течение 2-3 минут, чтобы собрать статистику потерь. Помогает найти "плохой" роутер, который теряет пакеты (Packet Loss). В Linux аналог — утилита **MTR** (`mtr google.com`). Она намного удобнее и показывает данные в реальном времени.

---

## 6. Просмотр статистики и портов (netstat)

Очень мощная команда. Показывает, кто подключен к вашему компьютеру прямо сейчас и какие порты "слушают" сеть.

**Популярные ключи:**

- **`netstat -a`**: Показать **все** подключения и слушающие порты (Listening).
- **`netstat -n`**: Показать **числа** (IP-адреса и порты) вместо имен (быстрее, так как не делает DNS-запросов).
- **`netstat -b`** (Windows, нужен админ): Показать **имя программы** (exe), которая открыла соединение.
- **`netstat -o`**: Показать PID процесса (чтобы потом убить его через диспетчер задач).

**Сценарий использования:** Вы поднимаете веб-сервер на порту 80, но он не стартует. Пишете `netstat -an | grep 80` (в Linux) или `netstat -an | find "80"` (в Windows). Видите, что порт 80 уже занят программой `Skype`.

> **Аналог в Linux:** Сейчас вместо `netstat` чаще используют команду `ss`.
> 
> - `ss -tuln` (TCP, UDP, Listening, Numeric) — "золотой стандарт" проверки открытых портов.
>     

---

## 7. Telnet (Проверка портов)

Хотя Telnet как протокол управления устарел (небезопасен), клиент Telnet незаменим для проверки **открытых портов TCP**.

**Задача:** Пинг есть, но сайт не открывается. Может, закрыт порт 80? **Команда:** `telnet google.com 80`

- **Если экран стал черным:** Поздравляю, соединение установлено! Порт открыт.
- **Если "Connect failed":** Порт закрыт или блокируется фаерволом.
    

> **Внимание:** В Windows 10/11 клиент Telnet по умолчанию отключен. Его нужно включить в "Компонентах Windows". В Linux часто используют `nc` (netcat) или `telnet`, если установлен.

---

## Основные выводы (The Essentials)

- **ipconfig / all:** Полная инфа о сетевой карте (MAC, DNS, DHCP).
- **ping:** Базовая проверка "жив/мертв" по ICMP.
- **tracert:** Показывает путь и место обрыва.
- **netstat -an:** Показывает открытые порты и активные соединения.
- **Telnet:** Проверяет доступность конкретного порта (TCP).